
			<!-- made by Emilee Chen
					oct 2016
						@ emileechen.github.io -->


<!doctype html>
<html>
	<head>
		<title>Emilee Chen</title>
		<link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
		<link rel="stylesheet/less" type="text/css" href="/css/styles.less" />
	</head>

	<body>

		<div class="container">

			<div class="side">

				<div class="side-nav hidden">
					<div class="side-nav-top">
						<a class="smoothScroll" href="#">
						<i class="fa fa-chevron-up" aria-hidden="true"></i> Top
						</a>
					</div>
					<div class="side-nav-back">
						<a class="smoothScroll" href="#">
						<i class="fa fa-chevron-left" aria-hidden="true"></i> Back
						</a>
					</div>
				</div>

			</div>


			<div class="main">

				<img src="/me.jpg" class="circle">


				<h1>Face Morphing</h1>

					<h2>I. Introduction</h2>

					<p>
						A morph of two images is a combination of warping an image's shape to the other, and cross-dissolving the images' colours. This allows us to morph one object into another seamlessly as long as important features are preserved by defining corresponding points between the images. This can be used to morph one face into another, by outputting several in between morphs and compiling them into a gif or video and displayed as a morph sequence. It can also be used to find the average face of two faces. The mean of a population of faces can also be computed with the same idea by averaging out a whole collection of faces. These mean faces can be used to make caricatures, which is similar to computing the opposite of face morphing.
					</p>


					<h2>II. Morph Sequence</h2>

					<p>
						The basic idea behind creating a morph sequence is to create a series of "mid-way faces" that starts as the first image, and gradually becomes the second image. We will consider for now, the case where the "weight" of the images is 50. (50% the first face, and 50% the second face. The weight is the weight applied to the first image. So, the output would be <span class="code">p1 + (weight * (p2 - p1))</span>.) The difficulty is warping the shapes of the faces.
					</p>

					<p>
						Stretching an image around willy nilly will inadvertently warp features in the face that we do not want distorted. We also want these features on one image to match up with the same features on the second image. So, we would like to specify a series of points that are important, and a second series of the corresponding points of the second image. This is simply two arrays of coordinate tuples. I simply chose points to go around the eyebrow, nose, eyes, mouth, and face.
					</p>

					<p>
						The background colour, pose, and angle of the images make a big difference in how the result looks. We want to choose images that are similar with respect to these traits. I chose a portrait of myself and then found a similar image of Emma Watson. Although the backgrounds are quite different, they are not too distractingly different. The portrait of Emma Watson is from the September 2015 issue of Vogue UK.
					</p>

					<p>
						After defining the points, we must construct a triangulation of the points for each image. We also construct a triangulation of our goal face. The goal face in this case is the points halfway between the two faces at <span class="code">(p1 + p2) / 2</span>, where <span class="code">p1</span> is the points of image one, and <span class="code">p2</span> is the points of image two. The images below show the points and triangulations for both images.
					</p>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee.jpg">
								<div class="code caption btmrgt">
									original<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee_p.jpg">
								<div class="code caption btmrgt">
									selected points<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee_t.jpg">
								<div class="code caption btmrgt">
									triangulation<br>
								</div>
							</div>
						</div>
					</div>
					<div class="img-table attach">
						<div class="img-table-box">
							Triangulation of my face with important features chosen as points.
						</div>
					</div>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emma.jpg">
								<div class="code caption btmrgt">
									original<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emma_p.jpg">
								<div class="code caption btmrgt">
									selected points<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emma_t.jpg">
								<div class="code caption btmrgt">
									triangulation<br>
								</div>
							</div>
						</div>
					</div>
					<div class="img-table attach">
						<div class="img-table-box">
							Triangulation of Emma Watson's portrait with important features chosen as points.
						</div>
					</div>

					<p>
						The triangles give us much smaller portions of the image to transform. We can use Affine warp to transform one triangle into a corresponding triangle. This is done by multiplying a constructed Affine warp matrix <span class="code">M</span> of one triangle to another with a vector <span class="code">[[x], [y], [1]]</span>, where x and y are pixels in the new image, and the resulting vector <span class="code">[[x'], [y'], [1]]</span> tells us which pixel of the original image to reference.
					</p>

					<p>
						After warping both images using Affine warps on each individual triangle for each image, simply add the appropriate weight (in this case .5 and .5) of the images together.
					</p>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_23_1.jpg">
								<div class="code caption btmrgt">
									.5 of me<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_23.jpg">
								<div class="code caption btmrgt">
									combined<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_23_2.jpg">
								<div class="code caption btmrgt">
									.5 of Emma<br>
								</div>
							</div>
						</div>
					</div>
					<div class="img-table attach">
						<div class="img-table-box">
							The left and right images show the images after warping. The centre image shows the warped images combined, which is also the mid-way face of the two original images.
						</div>
					</div>

					<p>
						After being able to morph a face into some mid-way face, a morph sequence can easily be created by adjusting the weight applied to the images and their points. In order to create a 46 frame warp, simply generate with weights 0, 1/46, 2/46, ..., 1. The morph with weight 0 will be image one, and the morph with weight 1 will be image two.
					</p>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee.jpg">
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma.gif">
								<div class="code caption btmrgt">
									<a href="img/emilee-emma.gif" target="_blank">[x]</a>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emma.jpg">
							</div>
						</div>
					</div>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee.jpg">
								<div class="code caption btmrgt">
									0
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_5.jpg">
								<div class="code caption btmrgt">
									5
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_10.jpg">
								<div class="code caption btmrgt">
									10
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_15.jpg">
								<div class="code caption btmrgt">
									15
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_20.jpg">
								<div class="code caption btmrgt">
									20
								</div>
							</div>
						</div>
					</div>
					<div class="img-table attach">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_25.jpg">
								<div class="code caption btmrgt">
									25
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_30.jpg">
								<div class="code caption btmrgt">
									30
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_35.jpg">
								<div class="code caption btmrgt">
									35
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emilee-emma_40.jpg">
								<div class="code caption btmrgt">
									40
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/emma.jpg">
								<div class="code caption btmrgt">
									45
								</div>
							</div>
						</div>
					</div>

					<p>
						I also morphed the faces of President Obama and Angelina Jolie. These images are portraits taken by <a href="https://en.wikipedia.org/wiki/Martin_Schoeller" target="_blank">Martin Schoeller</a>. They are chosen for their quality and similarity in posture.
					</p>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama.jpg">
								<div class="code caption btmrgt">
									original<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama_p.jpg">
								<div class="code caption btmrgt">
									selected points<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama_t.jpg">
								<div class="code caption btmrgt">
									triangulation<br>
								</div>
							</div>
						</div>
					</div>
					<div class="img-table attach">
						<div class="img-table-box">
							Triangulation of President Obama's portrait with important features chosen as points.
						</div>
					</div>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/jolie.jpg">
								<div class="code caption btmrgt">
									original<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/jolie_p.jpg">
								<div class="code caption btmrgt">
									selected points<br>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/jolie_t.jpg">
								<div class="code caption btmrgt">
									triangulation<br>
								</div>
							</div>
						</div>
					</div>
					<div class="img-table attach">
						<div class="img-table-box">
							Triangulation of Angelina Jolie's portrait with important features chosen as points.
						</div>
					</div>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama.jpg">
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie.gif">
								<div class="code caption btmrgt">
									<a href="img/obama-jolie.gif" target="_blank">[x]</a>
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/jolie.jpg">
							</div>
						</div>
					</div>

					<div class="img-table">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama.jpg">
								<div class="code caption btmrgt">
									0
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie_5.jpg">
								<div class="code caption btmrgt">
									5
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie_10.jpg">
								<div class="code caption btmrgt">
									10
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie_15.jpg">
								<div class="code caption btmrgt">
									15
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie_20.jpg">
								<div class="code caption btmrgt">
									20
								</div>
							</div>
						</div>
					</div>
					<div class="img-table attach">
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie_25.jpg">
								<div class="code caption btmrgt">
									25
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie_30.jpg">
								<div class="code caption btmrgt">
									30
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie_35.jpg">
								<div class="code caption btmrgt">
									35
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/obama-jolie_40.jpg">
								<div class="code caption btmrgt">
									40
								</div>
							</div>
						</div>
						<div class="img-table-box">
							<div class="img-table-item">
								<img src="img/jolie.jpg">
								<div class="code caption btmrgt">
									45
								</div>
							</div>
						</div>
					</div>


					<h2>II. "Mean" Face of a Population</h2>

					<p>
						Now that we are able to get the average of two face, we can consider getting the average of many different faces. Doing this is mathematically simple. For example, when averaging the faces of ten people (<span class="code">n = 10</span>), let the weight of each face be <span class="code">1/n</span>, and proceed as before. The tricky part is selecting the images to be used and having them all aligned and using the same point selection system.
					</p>

					<p>
						Thankfully, there are databases out there that have this available. I used the <a href="http://fei.edu.br/~cet/facedatabase.html" target="_blank">FEI Face Database</a>, which is a database of Brazilian faces that come with files that have points for the eyebrows, eyes, nose, mouth, and face selected already. Unfortunately, this database has this is black and white, so the following images will not be in colour, but the same process can easily be applied to images with colour.
					</p>


				<div class="footer">
					<a href="https://www.instagram.com/emileechen/" class="icon"><i class="fa fa-instagram" aria-hidden="true"></i></a>
					<a href="https://github.com/emileechen" class="icon"><i class="fa fa-github" aria-hidden="true"></i></a>
					<a href="https://www.linkedin.com/in/emileechen" class="icon"><i class="fa fa-linkedin-square" aria-hidden="true"></i></a>
				</div>

			</div>
			
			<div class="side">

			</div>
			
		</div>


		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script type="text/javascript" src="/js/smoothscroll.js"></script>
		<script type="text/javascript" src="/js/magicstuff.js"></script>
		<script type="text/javascript" src="/css/less.js"></script>

	</body>
</html>
